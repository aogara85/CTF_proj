<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± - SecureCloud</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="/" class="logo">
                <span class="logo-icon">ğŸ”’</span>
                <span>SecureCloud</span>
            </a>
            <nav>
                <a href="/">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
                <a href="/settings.html">è¨­å®š</a>
                <a href="/debug.html" class="active">ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</a>
            </nav>
            <div class="user-badge">
                <span class="status-dot"></span>
                <span id="currentUser">guest</span>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <h2>ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­</h2>
            <p style="color: var(--text-muted); margin-bottom: 2rem;">
                é–‹ç™ºè€…ã¨ç®¡ç†è€…å‘ã‘ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã¨å†…éƒ¨çŠ¶æ…‹ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã€‚
            </p>
            
            <button onclick="loadDebugInfo()" style="margin-bottom: 1.5rem;">
                ğŸ”„ è¨ºæ–­æƒ…å ±ã‚’æ›´æ–°
            </button>
            
            <div id="debugOutput" class="debug-output">
è¨ºæ–­ã‚’åˆæœŸåŒ–ä¸­...
            </div>
        </div>

        <div class="card">
            <h2>å®Ÿè¡Œç’°å¢ƒ</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³</div>
                    <div class="stat-value" style="font-size: 1.25rem;">v18.x</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                    <div class="stat-value" style="font-size: 1.25rem;">Linux</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ç¨¼åƒæ™‚é–“</div>
                    <div class="stat-value" id="uptime" style="font-size: 1.25rem;">--</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰è¨ºæ–­</h2>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
                JavaScriptãƒ©ãƒ³ã‚¿ã‚¤ãƒ åˆ†æã¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ¤œæŸ»ã€‚
            </p>
            
            <button onclick="runClientTests()" style="margin-bottom: 1.5rem;">
                â–¶ï¸ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
            </button>
            
            <div id="testOutput" class="debug-output">
ã€Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦JavaScriptãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’åˆ†æ...
            </div>
        </div>

        <div class="card">
            <h2>APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h2>
            <div class="info-box">
                <h3 style="color: var(--secondary); margin-bottom: 1rem;">åˆ©ç”¨å¯èƒ½ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</h3>
                
                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="background: var(--success); color: var(--bg-dark); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">POST</span>
                        <code style="color: var(--primary);">/api/update-settings</code>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-left: 3.5rem;">ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã®æ›´æ–°</p>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="background: var(--secondary); color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">GET</span>
                        <code style="color: var(--primary);">/api/admin/flag</code>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-left: 3.5rem;">ç®¡ç†ãƒªã‚½ãƒ¼ã‚¹ã‚­ãƒ¼ã®å–å¾—ï¼ˆç®¡ç†è€…æ¨©é™ãŒå¿…è¦ï¼‰</p>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="background: var(--secondary); color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">GET</span>
                        <code style="color: var(--primary);">/api/debug</code>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-left: 3.5rem;">ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­ã¨å†…éƒ¨çŠ¶æ…‹</p>
                </div>

                <div>
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="background: var(--secondary); color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">GET</span>
                        <code style="color: var(--primary);">/api/user/:username</code>
                    </div>
                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-left: 3.5rem;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®å–å¾—</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let startTime = Date.now();

        async function loadDebugInfo() {
            const output = document.getElementById('debugOutput');
            output.textContent = 'è¨ºæ–­æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...';
            
            try {
                const response = await fetch('/api/debug');
                const data = await response.json();
                
                output.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                output.textContent = `æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${error.message}`;
            }
        }

        function runClientTests() {
            const output = document.getElementById('testOutput');
            const results = [];

            results.push('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
            results.push('â•‘      JavaScript ãƒ©ãƒ³ã‚¿ã‚¤ãƒ åˆ†æ v1.0                 â•‘');
            results.push('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            results.push('');

            results.push('â”€â”€â”€ ãƒ†ã‚¹ãƒˆ 1: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—åˆ†æ â”€â”€â”€');
            const emptyObj = {};
            results.push(`â€¢ ç©ºã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å›ºæœ‰ã‚­ãƒ¼: [${Object.keys(emptyObj).join(', ') || 'ãªã—'}]`);
            results.push(`â€¢ ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã« 'defaultRole' ãŒå­˜åœ¨: ${'defaultRole' in emptyObj}`);
            results.push(`â€¢ defaultRole ã®å€¤: ${emptyObj.defaultRole || 'undefined'}`);
            results.push('');

            results.push('â”€â”€â”€ ãƒ†ã‚¹ãƒˆ 2: ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³æ§‹é€  â”€â”€â”€');
            results.push(`â€¢ Object.prototype ã®åˆ—æŒ™å¯èƒ½ãªã‚­ãƒ¼: [${Object.keys(Object.prototype).join(', ') || 'ãªã—'}]`);
            results.push(`â€¢ ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“æ¤œå‡º: ${Object.keys(Object.prototype).length > 0 ? 'ã¯ã„ âš ï¸' : 'ã„ã„ãˆ âœ“'}`);
            results.push('');

            results.push('â”€â”€â”€ ãƒ†ã‚¹ãƒˆ 3: ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¹ â”€â”€â”€');
            const testObj = {};
            results.push(`â€¢ testObj.constructor === Object: ${testObj.constructor === Object}`);
            results.push(`â€¢ testObj.constructor.prototype === Object.prototype: ${testObj.constructor.prototype === Object.prototype}`);
            results.push('');

            results.push('â”€â”€â”€ ãƒ†ã‚¹ãƒˆ 4: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ â”€â”€â”€');
            const childObj = Object.create({ inheritedProp: 'ç¶™æ‰¿ã•ã‚ŒãŸå€¤' });
            childObj.ownProp = 'å›ºæœ‰ã®å€¤';
            results.push(`â€¢ å›ºæœ‰ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: ${childObj.ownProp}`);
            results.push(`â€¢ ç¶™æ‰¿ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: ${childObj.inheritedProp}`);
            results.push(`â€¢ hasOwnProperty('ownProp'): ${childObj.hasOwnProperty('ownProp')}`);
            results.push(`â€¢ hasOwnProperty('inheritedProp'): ${childObj.hasOwnProperty('inheritedProp')}`);
            results.push('');

            results.push('â”€â”€â”€ ãƒ†ã‚¹ãƒˆ 5: æ±šæŸ“çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ â”€â”€â”€');
            const checkObj = {};
            results.push(`â€¢ Object.prototype ã®æ•´åˆæ€§ã‚’ç¢ºèªä¸­...`);
            if ('defaultRole' in checkObj) {
                results.push(`â€¢ âš ï¸  æ±šæŸ“ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸï¼`);
                results.push(`â€¢ æ±šæŸ“ã•ã‚ŒãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ 'defaultRole' = '${checkObj.defaultRole}'`);
                results.push(`â€¢ ã‚·ã‚¹ãƒ†ãƒ æ•´åˆæ€§: ä¾µå®³ã•ã‚Œã¦ã„ã¾ã™`);
            } else {
                results.push(`â€¢ âœ“  æ±šæŸ“ã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ`);
                results.push(`â€¢ ã‚·ã‚¹ãƒ†ãƒ æ•´åˆæ€§: æ­£å¸¸ã§ã™`);
            }
            results.push('');

            results.push('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            results.push(`åˆ†æå®Œäº†æ™‚åˆ»: ${new Date().toLocaleTimeString('ja-JP')}`);

            output.textContent = results.join('\n');
        }

        function updateUptime() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const hours = Math.floor(elapsed / 3600);
            const minutes = Math.floor((elapsed % 3600) / 60);
            const seconds = elapsed % 60;
            document.getElementById('uptime').textContent = 
                `${hours}æ™‚é–“ ${minutes}åˆ† ${seconds}ç§’`;
        }

        loadDebugInfo();
        setInterval(updateUptime, 1000);
    </script>
</body>
</html>